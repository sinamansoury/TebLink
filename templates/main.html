{% extends 'layout.html' %}
{% load static %}

{% block title %}TebLink{% endblock %}
{% block content %}
    <!-- کانتینر اصلی -->
    <div class="max-w-6xl w-full">
        <h1 class="text-4xl font-extrabold text-blue-600 text-center mb-8"></h1>
        <div class="flex justify-center items-center bg-white shadow-md rounded-lg w-full max-w-3xl mx-auto">
            <input type="text" placeholder="جستجوی پزشک، تخصص یا کلینیک..."
                   class="w-full py-2 px-3 rounded-md outline-none text-gray-700">
            <button class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 ml-3">
                جستجو 🔍
            </button>
        </div>

        <h1 class="text-4xl font-extrabold text-blue-600 text-center mb-8"></h1>
        <div id="specialities" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
    </div>

    <script >
    const API_BASE_URL = "https://teblink.onrender.com/api/consultant/";

async function fetchSpecialities() {
    try {
        const response = await fetch(API_BASE_URL);
        const data = await response.json(); // دریافت داده‌ها از API
        $('#specialities').empty(); // پاک کردن اطلاعات قبلی

        data.forEach(consultant => {
            // لینک به صفحه دکترهای مربوط به تخصص
            const specialityLink = `/doctor/${consultant.consultant}`;
            $('#specialities').append(`
                <a href="${specialityLink}" class="block speciality-link" data-link="${specialityLink}">
                    <div class="bg-white p-5 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition duration-300 transform hover:-translate-y-1">
                        <p class="text-blue-600 text-lg font-semibold text-center">🔬 ${consultant.consultant}</p>
                        <p class="text-gray-500 text-sm text-center mt-1">👨‍⚕️ تعداد پزشکان: <span class="font-bold">${consultant.count}</span></p>
                    </div>
                </a>
            `);
        });
        // اضافه کردن رویداد کلیک به هر لینک
        $('.speciality-link').on('click', function () {
            const specialityName = $(this).data('link').split('/').pop();  // استخراج نام تخصص از لینک
            fetchDoctorsBySpeciality(specialityName); // فراخوانی تابع برای دریافت دکترها
        });

    } catch (error) {
        console.error("Error fetching specialities:", error);
    }
}

$(document).ready(fetchSpecialities);
    </script>
{% endblock %}
        
    


